var calculator=function(){var t=$("#startOverBtn"),u=$("#calculateBtn"),k=$(".form"),g=$("#user-risk-text"),n=$("input:radio[name=user-risk-radio]"),v=$("input:radio[name=us-fna-radio]"),p=$("#calculator-input"),q=$("#calculator-result"),r=$("#computed-diagram"),w=$("#computed-value"),x=$("#malignancy-count-text"),y=$("#non-malignancy-count-text"),d=null,l=null,z=function(){var a=[];a.nonDiagnostic={estimate:.515,lower97ci:.336,upper95ci:.791};a.benign={estimate:.093,lower97ci:.063,upper95ci:.139};
a.aus={estimate:.405,lower97ci:.228,upper95ci:.719};a.suspiciousForFollicularNeoplasm={estimate:.608,lower97ci:.365,upper95ci:1.01};a.suspiciousForMalignancy={estimate:8.35,lower97ci:3.63,upper95ci:19.23};a.malignant={estimate:196.77,lower97ci:67.99,upper95ci:569.51};return{compute:function(b,c){var e=a[c],d=b/(1-b),h=d*e.estimate,f=d*e.lower97ci,e=d*e.upper95ci;return{preTestOdds:d,postTestOddsEstimate:h,postTestProbabilityEstimate:h/(1+h)*100,postTestOddsLower:f,postTestProbabilityLower:f/(1+f)*
100,postTestOddsHigher:e,postTestProbabilityHigher:e/(1+e)*100}}}}(),s=function(){l=d=null;k.trigger("reset");$(window).bind("beforeunload",function(){k.trigger("reset")});g.focus(function(){n.prop("checked",!1)}).change(function(){var a=$(this).val(),b=!1,c=null;/^\d{1,3}$/.test(a)&&(c=parseInt(a),1<=c&&100>=c&&(b=!0));b?($(this).removeClass("invalid").addClass("valid"),d=c/100):($(this).removeClass("valid").addClass("invalid"),d=null)});n.change(function(){d=$(this).val();g.val("")});v.change(function(){l=
$(this).val()});u.click(function(){var a=!0;null==d&&(a=!1,Materialize.toast("Probability of nodule's thyroid malignancy required.",2500));null==l&&(a=!1,Materialize.toast("US-FNA result required.",2500));a&&A()});q.addClass("hide");p.removeClass("hide")},A=function(){var a=0,b="",b=z.compute(d,l),c=Math.round(b.postTestProbabilityEstimate),e=100-c,k=Math.round(b.postTestProbabilityLower),h=Math.round(b.postTestProbabilityHigher);r.empty();for(var f=0;10>f;++f){var m=$('<div class="row center-align"  style="padding:0; margin: 0">');
m.append('<div class="col s1" style="padding:0; margin: 0;">&nbsp;</div>');for(var g=0;10>g;++g)b=a++<c?"red-text":"teal-text",m.append('<div class="col s1"  style="padding: 0; margin: 0;"><i class="flow-text mdi-social-person '+b+'"></i></div>');m.append('<div class="col s1" style="padding:0; margin: 0;">&nbsp;</div>');r.append(m)}x.text(c+" patient"+(1!=c?"s":"")+" with malignancy");y.text(e+" patient"+(1!=e?"s":"")+" without malignancy");w.text(c+" % ( "+k+" \u2013 "+h+" )");t.click(function(){s()});
p.addClass("hide");q.removeClass("hide")};return{start:function(){s()}}}();calculator.start();
