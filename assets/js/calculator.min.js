var calculator=function(){var r=$("#startOverBtn"),s=$("#calculateBtn"),t=$(".form"),k=$("#user-risk-text"),h=$("input:radio[name=user-risk-radio]"),u=$("input:radio[name=us-fna-radio]"),n=$("#calculator-input"),p=$("#calculator-result"),q=$("#computed-diagram"),v=$("#computed-value"),w=$(".risk-info");$(".risk-description");var x=$("#malignancy-count-text"),y=$("#non-malignancy-count-text"),e=null,m=null,z=function(){var a=[];a.nonDiagnostic={estimate:.515,lower97ci:.336,upper95ci:.791};a.benign=
{estimate:.093,lower97ci:.063,upper95ci:.139};a.aus={estimate:.405,lower97ci:.228,upper95ci:.719};a.suspiciousForFollicularNeoplasm={estimate:.608,lower97ci:.365,upper95ci:1.01};a.suspiciousForMalignancy={estimate:8.35,lower97ci:3.63,upper95ci:19.23};a.malignant={estimate:196.77,lower97ci:67.99,upper95ci:569.51};return{compute:function(b,c){var d=a[c],f=b/(1-b),e=f*d.estimate,g=f*d.lower97ci,d=f*d.upper95ci;return{preTestOdds:f,postTestOddsEstimate:e,postTestProbabilityEstimate:e/(1+e)*100,postTestOddsLower:g,
postTestProbabilityLower:g/(1+g)*100,postTestOddsHigher:d,postTestProbabilityHigher:d/(1+d)*100}}}}(),B=function(){$(window).bind("beforeunload",function(){t.trigger("reset")});k.focus(function(){h.prop("checked",!1)}).change(function(){var a=$(this).val(),b=!1,c=null;/^\d{1,3}$/.test(a)&&(c=parseInt(a),1<=c&&100>=c&&(b=!0));b?($(this).removeClass("invalid").addClass("valid"),e=c/100):($(this).removeClass("valid").addClass("invalid"),e=null)});h.change(function(){e=$(this).val();k.val("")});u.change(function(){m=
$(this).val()});s.click(function(){var a=!0;null==e&&(a=!1,Materialize.toast("Valid probability of nodule's thyroid malignancy required.",2500));null==m&&(a=!1,Materialize.toast("US-FNA result required.",2500));a&&A()});w.click(function(){var a=$(this);a.addClass("hide");a.parent().find(".risk-description").removeClass("hide")});p.addClass("hide");n.removeClass("hide")},A=function(){var a=0,b="",b=z.compute(e,m),c=Math.round(b.postTestProbabilityEstimate),d=100-c,f=Math.round(b.postTestProbabilityLower),
k=Math.round(b.postTestProbabilityHigher);q.empty();for(var g=0;10>g;++g){var l=$('<div class="row center-align"  style="padding:0; margin: 0">');l.append('<div class="col s1" style="padding:0; margin: 0;">&nbsp;</div>');for(var h=0;10>h;++h)b=a++<c?"red-text":"teal-text",l.append('<div class="col s1"  style="padding: 0; margin: 0;"><i class="flow-text mdi-social-person '+b+'"></i></div>');l.append('<div class="col s1" style="padding:0; margin: 0;">&nbsp;</div>');q.append(l)}x.text(c+" patient"+(1!=
c?"s":"")+" with malignancy");y.text(d+" patient"+(1!=d?"s":"")+" without malignancy");v.text(c+" % ( "+f+" \u2013 "+k+" )");r.click(function(){window.location="/dxtools/thyroid-nodules/"});n.addClass("hide");p.removeClass("hide")};return{start:function(){B()}}}();calculator.start();
