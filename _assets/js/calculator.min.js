var calculator=function(){var t=$("#startOverBtn"),u=$("#calculateBtn"),v=$(".form"),k=$("#user-risk-text"),g=$("input:radio[name=user-risk-radio]"),w=$("input:radio[name=us-fna-radio]"),n=$("#calculator-input"),p=$("#calculator-result"),q=$("#computed-diagram"),x=$("#computed-value"),y=$(".risk-info"),z=$("#malignancy-count-text"),A=$("#non-malignancy-count-text"),B=$("#result-probability"),C=$("#result-us-fna"),d=null,m=null,r=null,D=function(){var a=[];a.nonDiagnostic={estimate:.515,lower97ci:.336,
upper95ci:.791};a.benign={estimate:.093,lower97ci:.063,upper95ci:.139};a.aus={estimate:.405,lower97ci:.228,upper95ci:.719};a.suspiciousForFollicularNeoplasm={estimate:.608,lower97ci:.365,upper95ci:1.01};a.suspiciousForMalignancy={estimate:8.35,lower97ci:3.63,upper95ci:19.23};a.malignant={estimate:196.77,lower97ci:67.99,upper95ci:569.51};return{compute:function(b,c){var e=a[c],d=b/(1-b),h=d*e.estimate,f=d*e.lower97ci,e=d*e.upper95ci;return{preTestOdds:d,postTestOddsEstimate:h,postTestProbabilityEstimate:h/
(1+h)*100,postTestOddsLower:f,postTestProbabilityLower:f/(1+f)*100,postTestOddsHigher:e,postTestProbabilityHigher:e/(1+e)*100}}}}(),F=function(){$(window).bind("beforeunload",function(){v.trigger("reset")});k.focus(function(){g.prop("checked",!1)}).change(function(){var a=$(this).val(),b=!1,c=null;/^\d{1,3}$/.test(a)&&(c=parseInt(a),1<=c&&100>=c&&(b=!0));b?($(this).removeClass("invalid").addClass("valid"),d=c/100):($(this).removeClass("valid").addClass("invalid"),d=null)});g.change(function(){d=$(this).val();
k.val("")});w.change(function(){m=$(this).val();r=$(this).parent().find("label").text()});u.click(function(){var a=!0;null==d&&(a=!1,Materialize.toast("Valid probability of nodule's thyroid malignancy required.",2500));null==m&&(a=!1,Materialize.toast("US-FNA result required.",2500));a&&E()});y.click(function(){var a=$(this);a.addClass("hide");a.parent().find(".risk-description").removeClass("hide")});p.addClass("hide");n.removeClass("hide")},E=function(){var a=0,b="",b=D.compute(d,m),c=Math.round(b.postTestProbabilityEstimate),
e=100-c,k=Math.round(b.postTestProbabilityLower),h=Math.round(b.postTestProbabilityHigher);q.empty();for(var f=0;10>f;++f){var l=$('<div class="row center-align"  style="padding:0; margin: 0">');l.append('<div class="col s1" style="padding:0; margin: 0;">&nbsp;</div>');for(var g=0;10>g;++g)b=a++<c?"red-text":"teal-text",l.append('<div class="col s1"  style="padding: 0; margin: 0;"><i class="flow-text mdi-social-person '+b+'"></i></div>');l.append('<div class="col s1" style="padding:0; margin: 0;">&nbsp;</div>');
q.append(l)}B.text(d);C.text(r);z.text(c+" patient"+(1!=c?"s":"")+" with malignancy");A.text(e+" patient"+(1!=e?"s":"")+" without malignancy");x.text(c+" % ( "+k+" \u2013 "+h+" )");t.click(function(){window.location="/thyroid-nodules"});n.addClass("hide");p.removeClass("hide")};return{start:function(){F()}}}();calculator.start();
