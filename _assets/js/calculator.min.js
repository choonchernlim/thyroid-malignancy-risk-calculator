var calculator=function(){var t=$(".brand-logo").attr("href"),u=$("#startOverBtn"),v=$("#calculateBtn"),w=$(".form"),h=$("#user-risk-text"),k=$("input:radio[name=user-risk-radio]"),x=$("input:radio[name=us-fna-radio]"),n=$("#calculator-input"),p=$("#calculator-result"),q=$("#computed-diagram"),y=$(".risk-info"),z=$("#malignancy-count-text"),A=$("#non-malignancy-count-text"),B=$("#result-probability"),C=$("#result-us-fna"),c=null,m=null,r=null,D=function(){var a=[];a.nonDiagnostic={estimate:.515,lower97ci:.336,
upper95ci:.791};a.benign={estimate:.093,lower97ci:.063,upper95ci:.139};a.aus={estimate:.405,lower97ci:.228,upper95ci:.719};a.suspiciousForFollicularNeoplasm={estimate:.608,lower97ci:.365,upper95ci:1.01};a.suspiciousForMalignancy={estimate:8.35,lower97ci:3.63,upper95ci:19.23};a.malignant={estimate:196.77,lower97ci:67.99,upper95ci:569.51};return{compute:function(b,e){var d=a[e],g=b/(1-b),c=g*d.estimate,f=g*d.lower97ci,d=g*d.upper95ci;return{preTestOdds:g,postTestOddsEstimate:c,postTestProbabilityEstimate:c/
(1+c)*100,postTestOddsLower:f,postTestProbabilityLower:f/(1+f)*100,postTestOddsHigher:d,postTestProbabilityHigher:d/(1+d)*100}}}}(),F=function(){$(window).bind("beforeunload",function(){w.trigger("reset")});h.focus(function(){k.prop("checked",!1)}).change(function(){var a=$(this).val(),b=!1,e=null;/^\d{1,3}$/.test(a)&&(e=parseInt(a),1<=e&&100>=e&&(b=!0));b?($(this).removeClass("invalid").addClass("valid"),c=e/100):($(this).removeClass("valid").addClass("invalid"),c=null)});k.change(function(){c=$(this).val();
h.val("")});x.change(function(){m=$(this).val();r=$(this).parent().find("label").text()});v.click(function(){var a=!0;null==c&&(a=!1,Materialize.toast("Valid probability required.",2500));null==m&&(a=!1,Materialize.toast("US-FNA result required.",2500));a&&E()});y.click(function(){var a=$(this);a.addClass("hide");a.parent().find(".risk-description").removeClass("hide")});p.addClass("hide");n.removeClass("hide")},E=function(){var a=0,b="",b=D.compute(c,m),e=Math.round(b.postTestProbabilityEstimate),
d=Math.round(b.postTestProbabilityLower),g=Math.round(b.postTestProbabilityHigher);q.empty();for(var h=0;10>h;++h){var f=$('<div class="row center-align"  style="padding:0; margin: 0">');f.append('<div class="col s1" style="padding:0; margin: 0;">&nbsp;</div>');for(var k=0;10>k;++k)b=a++<e?"red-text":"teal-text",f.append('<div class="col s1"  style="padding: 0; margin: 0;"><i class="flow-text mdi-social-person '+b+'"></i></div>');f.append('<div class="col s1" style="padding:0; margin: 0;">&nbsp;</div>');
q.append(f)}B.text(100*c);C.text(r);z.text("Up to "+l(g)+" with thyroid cancer (or as few as "+l(d)+")");A.text("At least "+l(100-g)+" without thyroid cancer (at most "+l(100-d)+")");u.click(function(){window.location=t});n.addClass("hide");p.removeClass("hide")},l=function(a){return 1==a?a+" patient":a+" patients"};return{start:function(){F()}}}();calculator.start();
